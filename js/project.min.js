var global_game=!1,global_spielid="<<set by PHP>>",global_spielerid=0;function randomint(a,b){return Math.floor(Math.random()*(b+1-a)+a)}function set_message(a){$("div.outputs").html(" "+a);$("div.outputs").typewriter({speed:50});return!0}function show_html(a,b){$(b).html(a);return!0}function new_dialog(a,b){$("#dialog").attr("title",b);$("#dialog").html(a);$("#dialog").css("display","block");$("#dialog").dialog()}
function close_dialog(){$("#dialog").dialog("close");$("#dialog").css("display","none")}function reload_data(a){console.log(a);return!0}
function Feld(){this.max_x=9;this.max_y=11;this.koordtoletter={0:"A",1:"B",2:"C",3:"D",4:"E",5:"F",6:"G",7:"H",8:"I",9:"J",10:"K",11:"L"};this.empty_field=function(a){a='<div class="splf '+a+'"><div class="y">';a+='<div class="x">&nbsp;</div>';for(var b=0;b<=this.max_x;b++)a+='<div class="x x_'+b+'">'+b+"</div>";a+="</div>";for(b=0;b<=this.max_y;b++){a+='<div class="y y_'+b+'">';a+='<div class="x" title="'+b+'">'+this.koordtoletter[b]+"</div>";for(var d=0;d<=this.max_x;d++)a+='<div class="x y_'+b+
" x_"+d+" y_"+b+"x_"+d+'" title="'+this.koordtoletter[b]+" "+b+" | "+d+'">&nbsp;</div>';a+="</div>"}return a+="</div>"};this.show_field_shoots=function(a,b){$.each(a,function(a,c){var e;0==c.art?e="shoot_water":1==c.art?e="shoot_part":2==c.art&&(e="shoot_all");$("."+b+" div.y_"+c.y+"x_"+c.y).html('<span class="shoot '+e+'">&nbsp;</span>')});return!0};this.show_field_ships=function(a,b){var d=!1;$.each(a,function(a,e){var n=e.size;$.each(e.place,function(a,c){for(var e=c.x,l=c.y,g=c.d,t=c.t,p,q,r,
s,h=0;h<n;h++)"h"==g?(p=e+h,q=l):(p=e,q=l+h),r=0==h?"ship_bug":h==n-1?"ship_end":"ship_all",s=0==t[h]?"ship_black":"ship_red",$("."+b+" div.y_"+q+"x_"+p).html('<span class="ship '+r+"_"+g+" "+s+'">&nbsp;</span>');d=!0})});return d};this.make_shootable=function(a,b){$("."+a+" .x").click(function(){var a=$(this).attr("class").split(/\s+/),c=a[1].substr(2),a=a[2].substr(2);b.shoot_ships(a,c)});return!0}}
function Schiffe(a){global_spielerid++;this.id=global_spielerid;"undefined"===typeof a&&(a="Max Muster "+this.id);this.username=a;this.current=this.all=a={s:{name:"Schlachtschiff",size:5,anzahl:1,place:[]},k:{name:"Kreuzer",size:4,anzahl:2,place:[]},z:{name:"Zerst\u00f6rer",size:3,anzahl:3,place:[]},u:{name:"U-Boote",size:2,anzahl:4,place:[]}};this.shoots=[];this.place_random=function(){var a=this.all,d=new Feld,c=d.max_x,e=d.max_y;$.each(this.all,function(d,m){var f=m.size,k=m.anzahl;a[d].place=
[];for(var l=[],g=0;g<f;g++)l.push(0);for(g=0;g<k;g++)f={},1==randomint(0,1)?f.d="h":f.d="v",f.t=l,f.x=randomint(0,c),f.y=randomint(0,e),a[d].place.push(f)});this.current=a;return!0};this.shoot_ships=function(a,d){var c,e=0;$.each(this.current,function(n,m){$.each(m.place,function(f,k){if("h"==k.d){if(k.y!=d){c=0;return}}else if(k.x!=a){c=0;return}e++})});this.shoots.concat([{x:a,y:d,art:c}]);reload_data("shoot");2==c&&(reload_data("versenkt"),1==e&&reload_data("alle_versenkt"));return c}}
$(function(){start_game();testing()});function start_game(){set_message('Herzlich Willkommen bei "Schiffe versenken" von KIMB-technologies')}var schiffe,feld;
function testing(){schiffe=new Schiffe("Tester");feld=new Feld;var a=feld.empty_field("my_ships"),a=a+feld.empty_field("shoot_at");show_html(a+'<br /><span class="untertitel">Meine Schiffe</span><span class="untertitel">Schussfeld</span><br />',"div.area_one");a=schiffe.shoots;schiffe.place_random();var b=schiffe.current;feld.show_field_shoots(a,"shoot_at");feld.show_field_ships(b,"my_ships");feld.make_shootable("shoot_at",schiffe)}
$(function(){$("div.shoot_at .x").hover(function(){var a=$(this).attr("class").split(/\s+/);$("div.shoot_at ."+a[1]).css("background-color","#aeb");$("div.shoot_at ."+a[2]).css("background-color","#aeb");$("div.shoot_at ."+a[3]).css("background-color","#5d7")},function(){var a=$(this).attr("class").split(/\s+/);$("div.shoot_at ."+a[1]).css("background-color","white");$("div.shoot_at ."+a[2]).css("background-color","white");$("div.shoot_at ."+a[3]).css("background-color","white")})});
